<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìƒì¼ ì¶•í•˜ ë©”ì‹œì§€ ë¦¬ë·°</title>

  <!-- Firebase SDK (v8) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background:
        linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)),
        url("https://stimg.sooplive.co.kr/NORMAL_BBS/8/27626338/1597695f579401d68.jpg");
      background-size: cover;
      background-position: center;
      color: #fff;
      font-family: Pretendard, -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      text-align: center;
      padding: 40px 20px;
      overflow-x: hidden;
    }

    /* âœ¨ ë°˜ì§ì´ */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-image: radial-gradient(#ffffff66 1px, transparent 1px);
      background-size: 34px 34px;
      animation: sparkle 10s linear infinite;
      pointer-events: none;
    }

    @keyframes sparkle {
      from { transform: translateY(0); }
      to { transform: translateY(-34px); }
    }

    h2 {
      margin-bottom: 6px;
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -0.4px;
    }

    #counter {
      font-size: 14px;
      opacity: 0.85;
      margin-bottom: 16px;
    }

    /* ğŸ‚ ìƒì¼ ì¹´ë“œ */
    .card {
      background: linear-gradient(
        135deg,
        rgba(255,255,255,0.25),
        rgba(255,255,255,0.08)
      );
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 26px;
      padding: 42px 36px;
      max-width: 520px;
      margin: 20px auto;
      box-shadow: 0 35px 70px rgba(0,0,0,0.45);
      border: 1px solid rgba(255,255,255,0.35);
      color: #222;
      animation: pop 0.6s ease;
    }

    @keyframes pop {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .nickname {
      font-size: 15px;
      color: #ff6f91;
      font-weight: 600;
      margin-bottom: 14px;
    }

    #messageText {
  font-size: 24px;
  line-height: 1.55;
  font-weight: 600;
  color: #ffffff;
  white-space: pre-wrap;
  text-shadow: 0 2px 6px rgba(0,0,0,0.45);
	}

    .controls {
      margin-top: 26px;
    }

    .controls button {
      margin: 0 6px;
      padding: 12px 22px;
      font-size: 15px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .controls button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }

    #prev,
    #next {
      background: rgba(255,255,255,0.85);
      color: #333;
    }

    #speak {
      background: linear-gradient(135deg, #ff4ecd, #ff8a00);
      color: #fff;
      font-weight: 800;
    }
  </style>
</head>
<body>

  <h2>ğŸ‚ ìƒì¼ ì¶•í•˜ ë©”ì‹œì§€ ğŸ‰</h2>
  <div id="counter"></div>

  <div class="card">
    <div class="nickname" id="nicknameText"></div>
    <p id="messageText">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
  </div>

  <div class="controls">
    <button id="prev">ì´ì „</button>
    <button id="speak">ğŸ”Š ìŒì„± ì¶œë ¥</button>
    <button id="next">ë‹¤ìŒ</button>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDtDtadwFVoYMSahJyeNKqh-3NfwSagi-o",
      authDomain: "eunbin-4ba29.firebaseapp.com",
      projectId: "eunbin-4ba29",
      storageBucket: "eunbin-4ba29.firebasestorage.app",
      messagingSenderId: "1042774764206",
      appId: "1:1042774764206:web:1068894ff8f3c583ef5b3f",
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let messages = [];
    let index = 0;

    const messageEl = document.getElementById("messageText");
    const nicknameEl = document.getElementById("nicknameText");
    const counterEl = document.getElementById("counter");

    db.collection("birthday_messages")
      .where("approved", "==", true)
      .orderBy("order", "asc")
      .onSnapshot(snapshot => {
        messages = snapshot.docs.map(doc => doc.data());
        index = 0;
        render();
      });

    function render() {
      if (messages.length === 0) {
        messageEl.innerText = "í‘œì‹œí•  ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤.";
        nicknameEl.innerText = "";
        counterEl.innerText = "";
        return;
      }

      const current = messages[index];
      messageEl.innerText = current.message;
      nicknameEl.innerText = `from. ${current.nickname || "ìµëª…"}`;
      counterEl.innerText = `${index + 1} / ${messages.length}`;
    }

    document.getElementById("prev").onclick = () => {
      if (index > 0) {
        index--;
        render();
      }
    };

    document.getElementById("next").onclick = () => {
      if (index < messages.length - 1) {
        index++;
        render();
      }
    };

    document.getElementById("speak").onclick = () => {
      if (!messages[index]) return;

      const u = new SpeechSynthesisUtterance(messages[index].message);
      u.lang = "ko-KR";
      u.rate = 1.15;
      u.pitch = 1.2;
      u.volume = 1;

      speechSynthesis.cancel();
      speechSynthesis.speak(u);
    };
  </script>

</body>
</html>
